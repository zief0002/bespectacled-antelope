---
title: "Quarto Tips, Tricks, and FAQ"
format:
  html:
    code-copy: true
    code-fold: false
    highlight-style: zenburn
    df-print: paged
    css: ["../assets/sticky-notes.css"]
date: "`r format(Sys.Date(), '%B %d %Y')`"
bibliography: "../assets/epsy8252.bib"
csl: "../assets/apa-single-spaced.csl"
---

```{r}
#| echo: false
source("../assets/notes-setup.R")
```

This document contains a few more tips, tricks, and helpful instruction for EPsy 8252. Note that I might add to this as students hit me with questions over the course of the semester.

<br />


# Multiline Equations

There are a couple of ways to create multiline equations in a Quarto document. I tend to use the `split` environment from LaTeX to do this. To use this: 

- Include `\begin{split}` and `\end{split}` in the display equation. 
- At the end of each line (where you want a linebreak) include a double backslash, `\\`. 
- In each line of the multiline equation, also include the ampersand sign (`&`) at the point we want the multiple lines to align vertically. 

Here is an example:

```{r}
#| echo: false
knitr::include_graphics("figs/02-multiline-equation-01.png")
```


$$
\begin{split}
\hat{y}_i &= 3 + 4(1) \\
&= 7
\end{split}
$$


Note that the ampersand appeared immediately befor the equal sign in each line of the equation, so that is where the two lines are aligned vertically (the equal signs are on top of each other). You can add as many lines to this as you want.

:::protip
Multiline equations are quite useful to show your work and when you have really long single equations that need to be broken up so they fit on the page (e.g., a regression equation with many predictors).
:::

<br />


## Spacing Out the Lines

You can add space between the lines of your multiline equation by including a unit of measurement between square brackets after the double backslashes.

```{r}
#| echo: false
knitr::include_graphics("figs/02-multiline-equation-02.png")
```

$$
\begin{split}
\hat{y}_i &= 3 + 4(1) \\[1em]
&= 7
\end{split}
$$

Here we have added line space of 1 em. An *em* is a unit for measuring the width of printed work, equal to the height of the type size being used (typically the width of the letter "m"). Other common printing units include the *en* (the width of the letter "n"), and the *ex* (the width of the letter "x"). 

<br />


# Hyphens, Minus Signs, and Dashes

In printed work the width of a hyphen, a minus sign, and dashes are all different. Quarto will correctly typeset these, but you have to indicate what you want. Below are how we indicate these in Quarto.

- **Hyphen:** A hyphen is used to join two or more words together. To typeset a hyphen in Quarto, use a single hyphen; `-`.
- **En Dash:** An en dash is used to mark ranges and to indicate the meaning "to" in phrases like "Minneapolis--St. Paul". An en dash is slightly longer than a hyphen and is typeset in Quarto using two hyphens; `--`.
- **Em Dash:** An em dash is used to separate extra information or mark a break in a sentence. An em dash is slightly longer than an en dash and is typeset in Quarto using three hyphens; `---`.
- **Minus Sign:** A minus sign is used in mathematical expressions (e.g., in subtraction or to indicate a negative number). To typeset a minus sign, use the inline equation with a single hyphen; `$-$`. When a minus sign is typeset, not only is the length of it different than a hyphen, but it also includes the correct spacing around it for mathematical typesetting.

Here is a sentence incorporating each of these so you can see the differences:

*During the time from January--February, my three dogs enjoy playing in the snow---apparently snow is fun for canines---with their sweaters on since it is $-30$-degrees Fahrenheit outside.*

The input for this sentence was:

`During the time from January--February, my three dogs enjoy playing in the snow---apparently snow is fun for canines---with their sweaters on since it is $-30$-degrees Fahrenheit outside.`


Note that you can also typeset these in Word:

- **Hyphen:** On both a Mac and PC, press "hyphen".
- **En Dash:** On a Mac, press "option+hyphen key". On a PC, press "ctrl+hyphen".
- **Em Dash:**  On a Mac, press "option+shift+hyphen key". On a PC, press "alt+ctrl+hyphen".
- **Minus Sign:** For a minus sign, you should use Equation Editor.

<br />


# Citations

To add citations, we need to:

- Create a BibTeX (.bib) file that holds the metadata for our references.
- Save the BibTeX file to our project directory (typically in the `assets` directory)
- Include `bibliography: "location/bibliography-name.bib"` in the YAML of our QMD document

<br />


## BibTex Files

BibTeX files are essentially databases that store bibliographic information in a plain-text (style-independent) file. The database includes a set of references and their metadata. Here is the raw text inside an example BibTex file that includes two articles written by @carmichael_1954 and @ross_2020.

```
@article{carmichael_1954,
	title = {Laziness and the Scholarly Life},
	volume = {78},
	number = {4},
	journal = {The Scientific Monthly},
	author = {Carmichael, Leonard},
	year = {1954},
	pages = {208--213}
}

@article{ross_2020,
	title = {Racial disparities in police use of deadly force against unarmed individuals persist after appropriately benchmarking shooting data on violent crime rates},
	issn = {1948-5506, 1948-5514},
	url = {http://journals.sagepub.com/doi/10.1177/1948550620916071},
	doi = {10.1177/1948550620916071},
	language = {en},
	urldate = {2020-06-24},
	journal = {Social Psychological and Personality Science},
	author = {Ross, Cody T. and Winterhalder, Bruce and McElreath, Richard},
	month = jun,
	year = {2020},
	pages = {194855062091607}
}
```

The citation identifiers in this example are `carmichael_1954` and `ross_2020`. These identifiers are the first bit of text after the initial curly brace in the reference. This is how we will refer to the citations in our QMD document. (Typically these are auto-generated from our reference manager.) To determine the citiation identifiers, you can open your BibTeX file in RStudio. (Do this by using `Open File...` within RStudio; double-clicking on the BibTeX file will likely open it in a different application.)

<br />


## Creating .bib Files Using Zotero

Most reference managers (e.g., Papers, Zotero, Mendelay) can produce BibTex files. Here I will illustrate the process using Zotero.

- Create a `New Collection`.
- Drag the references you want in your BibTeX database into this collection.
- Right-click the collection and select `Export Collection`.
- In the pop-up window, change the format of the exported collection to `BibTex`.
- Click `OK`.

Name the BibTex file (here I named it `my_bibliography.bib`) and save it in the `Assets` folder. 


```{r}
#| echo: false
#| out-width: "90%"
knitr::include_graphics("figs/02-zotero-bibtex.png")
```

When you call the BibTex file in the `bibliography:` key of the YAML in your QMD document, you will need to give the location of the BibTex (relative to the QMD document) and the name you just gave it. For example if you are calling a bibliography in the quarto document `assignment-01.qmd` that has the following directory/folder structure:

```{r}
#| echo: false
knitr::include_graphics("figs/02-directory-tree.png")
```

You would include the following in your YAML.

```
title: "Assignment 1"
format: html
bibiography: "assets/my-bibliography.bib"
```


<br />


## Including Citations in Your Quarto Document

Citations go inside square brackets and are separated by semicolons. Each citation must have a key, composed of `@citation_identifier` from the database (no spaces between them). For example to cite the Carmichael article:

```
Here is some text and a citation [@carmichael_1954].
```

This will create a citation where you included it in the text and also add the reference at the end of the document. If you want a section header for your references, include a level-1 heading called "References" at the end of your document.

The rendered document now includes a citation where you added this is the QMD document. The associated reference is also included at the end of the document.

```{r}
#| echo: false
#| out-width: "90%"
knitr::include_graphics("figs/02-citations-01.png")
```


Citations may also include. additional text before and after the citation. In this example we have prefixed the citation with the word "see" and added a page number after the citation. The citation identifier and the text following the citation identifier are separated by a comma.

```
Here is some text and a citation [see @carmichael_1954, p. 208].
```

The output of this is:

> Here is some text and a citation [see @carmichael_1954, p. 208].

You can also include multiple citations. To do this we include the different citation identifiers separated by a semicolon.

```
Here are multiple citations [@ross_2020; @carmichael_1954].
```

The output of this is:

> Here are multiple citations [@ross_2020; @carmichael_1954].

We can also change the format of the citation. For example, here we use a format common to starting a sentence with a citation. To do that we omit the square brackets.

```
@carmichael_1954 suggests something is true.
```

The output of this is:

> @carmichael_1954 suggests something is true.


:::fyi
You can learn more on the [Citations and Footnotes Help Page](https://quarto.org/docs/authoring/footnotes-and-citations.html) in the Quarto documentation.
:::

<br />


## Use APA Formatted Citations and References

By default, citations and references are formatted using the Chicago style. To use another style, you will need to:

- Download the appropriate citation style language (CSL) file. (Find many at https://zotero.org/styles)
- Place the CSL file in the `assets` folder of your project's directory.
- Specify the name of the CSL style file in the `csl:` key in the QMD file's YAML.

For example, say you have downloaded and saved the `apa-single-spaced.csl` file as shown in the following directory/folder structure:

```{r}
#| echo: false
knitr::include_graphics("figs/02-directory-tree.png")
```

You would include the following in your YAML.

```
title: "Assignment 1"
format: html
bibiography: "assets/my-bibliography.bib"
csl: "assets/apa-single-spaced.csl"
```

Use of the APA CSL file not only formats the references according to APA format, but it also fixed the order of the citations in the text itself! (Even though we included the Ross citation identifier prior to the Carmichael citation identifier in the multiple references example, the APA CSL file put them in the text alphabetically!)

<br />


## Citation Extras

One R package that is extremely useful, especially if you are using the visual editor in RStudio for writing QMD documents, is `{citr}`. This package provides functionality and an RStudio Add-In to search a BibTeX-file to create and insert formatted Markdown citations into a QMD document.

```{r}
#| echo: false
knitr::include_graphics("figs/02-citr-package.png")
```

The `{citr} package is only available via GitHub, so you will need to install it using `{remotes}` or `{devtools}`. (See the Computational Toolkit book for a reminder on how to do this.) The directions for installing `{citr}` are also on the [citr webpage](https://github.com/crsh/citr) along with instructions for using the package. 


<br />


# References









